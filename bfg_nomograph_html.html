<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BFG Steam Generation Nomograph</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.5.0/dist/Recharts.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; }
        
        .container { width: 100%; min-height: 100vh; background: linear-gradient(to bottom right, #f8fafc, #dbeafe); padding: 1.5rem; overflow: auto; }
        .max-w-7xl { max-width: 80rem; margin: 0 auto; }
        
        .title { font-size: 1.875rem; font-weight: bold; color: #1e293b; margin-bottom: 0.5rem; }
        .subtitle { color: #64748b; margin-bottom: 1.5rem; }
        
        .card { background: white; border-radius: 0.5rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); padding: 1.5rem; margin-bottom: 1.5rem; }
        
        .grid { display: grid; gap: 1.5rem; }
        .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        
        @media (max-width: 768px) {
            .grid-cols-3, .grid-cols-2 { grid-template-columns: 1fr; }
        }
        
        .label { display: block; font-size: 0.875rem; font-weight: 600; color: #334155; margin-bottom: 0.5rem; }
        
        .slider { width: 100%; height: 0.5rem; border-radius: 0.5rem; appearance: none; cursor: pointer; outline: none; }
        .slider::-webkit-slider-thumb { appearance: none; width: 1.25rem; height: 1.25rem; border-radius: 50%; background: #3b82f6; cursor: pointer; }
        .slider::-moz-range-thumb { width: 1.25rem; height: 1.25rem; border-radius: 50%; background: #3b82f6; cursor: pointer; border: none; }
        
        .slider-blue { background: #bfdbfe; }
        .slider-green { background: #86efac; }
        .slider-orange { background: #fed7aa; }
        
        .slider-labels { display: flex; justify-content: space-between; font-size: 0.75rem; color: #64748b; margin-top: 0.25rem; }
        
        .info-box { padding: 0.75rem; background: #f1f5f9; border-radius: 0.5rem; border: 1px solid #cbd5e1; margin-top: 1rem; }
        .info-text { font-size: 0.875rem; color: #475569; }
        .info-bold { font-weight: 600; }
        
        .results-box { margin-top: 1.5rem; padding: 1rem; background: linear-gradient(to right, #eff6ff, #f0fdf4); border-radius: 0.5rem; border: 1px solid #93c5fd; }
        .results-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; }
        
        @media (max-width: 768px) {
            .results-grid { grid-template-columns: 1fr; }
        }
        
        .result-item { text-align: center; }
        .result-label { font-size: 0.875rem; color: #475569; font-weight: 500; }
        .result-value { font-size: 1.5rem; font-weight: bold; margin-top: 0.25rem; }
        .result-value-blue { color: #2563eb; }
        .result-value-orange { color: #ea580c; }
        .result-value-red { color: #dc2626; }
        .result-note { font-size: 0.75rem; color: #64748b; margin-top: 0.25rem; }
        
        .section-title { font-size: 1.25rem; font-weight: 600; color: #1e293b; margin-bottom: 1rem; }
        .section-subtitle { font-size: 0.875rem; color: #475569; margin-bottom: 0.75rem; }
        
        table { width: 100%; font-size: 0.875rem; border-collapse: collapse; }
        thead { background: #f1f5f9; }
        th, td { padding: 0.75rem; text-align: left; border-bottom: 1px solid #e2e8f0; }
        th { font-weight: 600; }
        td { color: #334155; }
        .text-center { text-align: center; }
        .text-red { color: #dc2626; font-weight: 500; }
        .text-gray { color: #64748b; }
        tbody tr:hover { background: #f8fafc; }
        
        .assumptions-box { background: #eff6ff; border: 1px solid #93c5fd; border-radius: 0.5rem; padding: 1rem; margin-top: 1.5rem; }
        .assumptions-title { font-weight: 600; color: #1e293b; margin-bottom: 0.5rem; }
        .assumptions-list { list-style: none; font-size: 0.875rem; color: #475569; }
        .assumptions-list li { margin: 0.25rem 0; }
        
        .overflow-auto { overflow-x: auto; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } = Recharts;

        const BFGNomograph = () => {
          const [selectedFlow, setSelectedFlow] = useState(24000);
          const [selectedCV, setSelectedCV] = useState(740);
          const [numBurners, setNumBurners] = useState(4);
          
          const BOILER_EFFICIENCY = 0.90;
          const STEAM_ENTHALPY = 660;
          
          const calculateSteamRate = (flowRate, cv, burners = 1) => {
            const totalFlowRate = flowRate * burners;
            const heatInput = totalFlowRate * cv;
            const effectiveHeat = heatInput * BOILER_EFFICIENCY;
            const steamKgPerHr = effectiveHeat / STEAM_ENTHALPY;
            return steamKgPerHr / 1000;
          };
          
          const generateCVData = () => {
            const data = [];
            for (let cv = 720; cv <= 760; cv += 2) {
              const steamRate = calculateSteamRate(selectedFlow, cv, numBurners);
              data.push({
                cv: cv,
                steamRate: parseFloat(steamRate.toFixed(2)),
                flowRate: selectedFlow
              });
            }
            return data;
          };
          
          const generateFlowData = () => {
            const data = [];
            for (let flow = 22000; flow <= 26000; flow += 200) {
              const steamRate = calculateSteamRate(flow, selectedCV, numBurners);
              data.push({
                flowRate: flow,
                steamRate: parseFloat(steamRate.toFixed(2)),
                cv: selectedCV
              });
            }
            return data;
          };
          
          const generateContourData = () => {
            const data = [];
            const cvRange = [720, 730, 740, 750, 760];
            
            for (let flow = 22000; flow <= 26000; flow += 500) {
              const point = { flowRate: flow };
              cvRange.forEach(cv => {
                point[`cv${cv}`] = parseFloat(calculateSteamRate(flow, cv, numBurners).toFixed(2));
              });
              data.push(point);
            }
            return data;
          };
          
          const cvData = generateCVData();
          const flowData = generateFlowData();
          const contourData = generateContourData();
          
          const currentSteam = calculateSteamRate(selectedFlow, selectedCV, numBurners);
          const steamAfterDrop = calculateSteamRate(selectedFlow, selectedCV - 1, numBurners);
          const deltaSteam = currentSteam - steamAfterDrop;
          
          const CustomTooltip = ({ active, payload, label }) => {
            if (active && payload && payload.length) {
              return (
                <div style={{background: 'white', padding: '12px', border: '1px solid #d1d5db', borderRadius: '4px', boxShadow: '0 4px 6px rgba(0,0,0,0.1)'}}>
                  <p style={{fontWeight: 600, marginBottom: '4px'}}>{`${payload[0].name}: ${label}`}</p>
                  <p style={{color: '#2563eb'}}>{`Steam: ${payload[0].value} TPH`}</p>
                </div>
              );
            }
            return null;
          };

          return (
            <div className="container">
              <div className="max-w-7xl">
                <h1 className="title">Blast Furnace Gas Steam Generation Nomograph</h1>
                <p className="subtitle">Visualize the impact of fuel CV and flow rate on steam generation</p>
                
                <div className="card">
                  <div className="grid grid-cols-3">
                    <div>
                      <label className="label">
                        Flow Rate per Burner: {selectedFlow.toLocaleString()} Nm³/hr
                      </label>
                      <input
                        type="range"
                        min="22000"
                        max="26000"
                        step="100"
                        value={selectedFlow}
                        onChange={(e) => setSelectedFlow(Number(e.target.value))}
                        className="slider slider-blue"
                      />
                      <div className="slider-labels">
                        <span>22,000</span>
                        <span>26,000</span>
                      </div>
                    </div>
                    
                    <div>
                      <label className="label">
                        Calorific Value: {selectedCV} kCal/Nm³
                      </label>
                      <input
                        type="range"
                        min="720"
                        max="760"
                        step="1"
                        value={selectedCV}
                        onChange={(e) => setSelectedCV(Number(e.target.value))}
                        className="slider slider-green"
                      />
                      <div className="slider-labels">
                        <span>720</span>
                        <span>760</span>
                      </div>
                    </div>
                    
                    <div>
                      <label className="label">
                        Number of Burners: {numBurners}
                      </label>
                      <input
                        type="range"
                        min="1"
                        max="8"
                        step="1"
                        value={numBurners}
                        onChange={(e) => setNumBurners(Number(e.target.value))}
                        className="slider slider-orange"
                      />
                      <div className="slider-labels">
                        <span>1</span>
                        <span>8</span>
                      </div>
                    </div>
                  </div>
                  
                  <div className="info-box">
                    <p className="info-text">
                      <span className="info-bold">Total Fuel Flow:</span> {(selectedFlow * numBurners).toLocaleString()} Nm³/hr 
                      <span style={{marginLeft: '1rem', color: '#64748b'}}>({numBurners} burner{numBurners > 1 ? 's' : ''} × {selectedFlow.toLocaleString()} Nm³/hr)</span>
                    </p>
                  </div>
                  
                  <div className="results-box">
                    <div className="results-grid">
                      <div className="result-item">
                        <p className="result-label">Current Steam Generation</p>
                        <p className="result-value result-value-blue">
                          {currentSteam.toFixed(2)} TPH
                        </p>
                      </div>
                      <div className="result-item">
                        <p className="result-label">After 1 kCal/Nm³ Drop</p>
                        <p className="result-value result-value-orange">
                          {steamAfterDrop.toFixed(2)} TPH
                        </p>
                      </div>
                      <div className="result-item">
                        <p className="result-label">Steam Loss (Δ)</p>
                        <p className="result-value result-value-red">
                          -{deltaSteam.toFixed(3)} TPH
                        </p>
                        <p className="result-note">
                          ({((deltaSteam/currentSteam)*100).toFixed(2)}% reduction)
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div className="card">
                  <h2 className="section-title">Steam Generation Contours</h2>
                  <ResponsiveContainer width="100%" height={400}>
                    <LineChart data={contourData}>
                      <CartesianGrid strokeDasharray="3 3" stroke="#e0e0e0" />
                      <XAxis 
                        dataKey="flowRate" 
                        label={{ value: 'Fuel Flow Rate per Burner (Nm³/hr)', position: 'insideBottom', offset: -5 }}
                        tickFormatter={(value) => value.toLocaleString()}
                      />
                      <YAxis 
                        label={{ value: 'Steam Generation (TPH)', angle: -90, position: 'insideLeft' }}
                      />
                      <Tooltip content={<CustomTooltip />} />
                      <Legend />
                      <Line type="monotone" dataKey="cv720" stroke="#1e40af" name="CV: 720 kCal/Nm³" strokeWidth={2} dot={false} />
                      <Line type="monotone" dataKey="cv730" stroke="#3b82f6" name="CV: 730 kCal/Nm³" strokeWidth={2} dot={false} />
                      <Line type="monotone" dataKey="cv740" stroke="#10b981" name="CV: 740 kCal/Nm³" strokeWidth={2} dot={false} />
                      <Line type="monotone" dataKey="cv750" stroke="#f59e0b" name="CV: 750 kCal/Nm³" strokeWidth={2} dot={false} />
                      <Line type="monotone" dataKey="cv760" stroke="#ef4444" name="CV: 760 kCal/Nm³" strokeWidth={2} dot={false} />
                    </LineChart>
                  </ResponsiveContainer>
                </div>
                
                <div className="grid grid-cols-2">
                  <div className="card">
                    <h2 className="section-title">Impact of CV Change</h2>
                    <p className="section-subtitle">
                      Flow: {selectedFlow.toLocaleString()} Nm³/hr/burner × {numBurners} burner{numBurners > 1 ? 's' : ''} = {(selectedFlow * numBurners).toLocaleString()} Nm³/hr total
                    </p>
                    <ResponsiveContainer width="100%" height={300}>
                      <LineChart data={cvData}>
                        <CartesianGrid strokeDasharray="3 3" stroke="#e0e0e0" />
                        <XAxis 
                          dataKey="cv" 
                          label={{ value: 'Calorific Value (kCal/Nm³)', position: 'insideBottom', offset: -5 }}
                        />
                        <YAxis 
                          label={{ value: 'Steam (TPH)', angle: -90, position: 'insideLeft' }}
                        />
                        <Tooltip content={<CustomTooltip />} />
                        <Line 
                          type="monotone" 
                          dataKey="steamRate" 
                          stroke="#3b82f6" 
                          strokeWidth={3}
                          dot={{ fill: '#3b82f6', r: 4 }}
                          name="Steam Rate"
                        />
                      </LineChart>
                    </ResponsiveContainer>
                  </div>
                  
                  <div className="card">
                    <h2 className="section-title">Impact of Flow Rate per Burner</h2>
                    <p className="section-subtitle">
                      CV: {selectedCV} kCal/Nm³ with {numBurners} burner{numBurners > 1 ? 's' : ''} in service
                    </p>
                    <ResponsiveContainer width="100%" height={300}>
                      <LineChart data={flowData}>
                        <CartesianGrid strokeDasharray="3 3" stroke="#e0e0e0" />
                        <XAxis 
                          dataKey="flowRate" 
                          label={{ value: 'Flow Rate per Burner (Nm³/hr)', position: 'insideBottom', offset: -5 }}
                          tickFormatter={(value) => value.toLocaleString()}
                        />
                        <YAxis 
                          label={{ value: 'Steam (TPH)', angle: -90, position: 'insideLeft' }}
                        />
                        <Tooltip content={<CustomTooltip />} />
                        <Line 
                          type="monotone" 
                          dataKey="steamRate" 
                          stroke="#10b981" 
                          strokeWidth={3}
                          dot={{ fill: '#10b981', r: 4 }}
                          name="Steam Rate"
                        />
                      </LineChart>
                    </ResponsiveContainer>
                  </div>
                </div>
                
                <div className="card">
                  <h2 className="section-title">
                    Quick Reference: Steam Loss per 1 kCal/Nm³ CV Drop (with {numBurners} burner{numBurners > 1 ? 's' : ''})
                  </h2>
                  <div className="overflow-auto">
                    <table>
                      <thead>
                        <tr>
                          <th>Flow/Burner (Nm³/hr)</th>
                          <th className="text-center">Total Flow (Nm³/hr)</th>
                          <th className="text-center">CV 760→759</th>
                          <th className="text-center">CV 750→749</th>
                          <th className="text-center">CV 740→739</th>
                          <th className="text-center">CV 730→729</th>
                          <th className="text-center">CV 720→719</th>
                        </tr>
                      </thead>
                      <tbody>
                        {[22000, 23000, 24000, 25000, 26000].map(flow => (
                          <tr key={flow}>
                            <td style={{fontWeight: 500}}>{flow.toLocaleString()}</td>
                            <td className="text-center text-gray">{(flow * numBurners).toLocaleString()}</td>
                            {[760, 750, 740, 730, 720].map(cv => {
                              const loss = calculateSteamRate(flow, cv, numBurners) - calculateSteamRate(flow, cv - 1, numBurners);
                              return (
                                <td key={cv} className="text-center text-red">
                                  -{loss.toFixed(3)} TPH
                                </td>
                              );
                            })}
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                </div>
                
                <div className="assumptions-box">
                  <h3 className="assumptions-title">Assumptions:</h3>
                  <ul className="assumptions-list">
                    <li>• Boiler efficiency: {(BOILER_EFFICIENCY * 100)}%</li>
                    <li>• Steam enthalpy: {STEAM_ENTHALPY} kCal/kg (saturated steam ~10 bar)</li>
                    <li>• Calculation: Steam Rate (TPH) = [(Flow per Burner × No. of Burners × CV × Efficiency) / Steam Enthalpy] / 1000</li>
                    <li>• Flow rate range per burner: 22,000 to 26,000 Nm³/hr</li>
                  </ul>
                </div>
              </div>
            </div>
          );
        };

        ReactDOM.render(<BFGNomograph />, document.getElementById('root'));
    </script>
</body>
</html>
